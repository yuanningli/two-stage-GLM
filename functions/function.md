functions used for the algorithm
